
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Coupled Differential Equations Continued! &#8212; Mathemtaical Methods for Chemical Engineering</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Nonlinear coupled ODE’s" href="18-nonlinear-coupled-ODEs.html" />
    <link rel="prev" title="Coupled Differential Equations" href="16-coupled-odes.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Mathemtaical Methods for Chemical Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Lecture notes for CMU 06-262 Math Methods in Chemical Engineering (Zachary Ulissi, CMU)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Notes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../linear_algebra/1-intro-matrices.html">
   Introduction to math methods for ChE and motivation for linear algebra
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linear_algebra/linear_algebra.html">
   Linear Algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_algebra/2-matrix-manipulation.html">
     Matrix/Linear Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_algebra/3-gauss-elimination.html">
     Intro to Gauss Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_algebra/4-rank-gauss-examples.html">
     Example of Gauss Elimination, and Matrix Rank/Inverse
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_algebra/5-determinants.html">
     Using matrix inverses, and matrix determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_algebra/6-eigenvalues-1.html">
     Eigenvalue and Eigenvectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_algebra/7-eigenvalue-2-difference-equations.html">
     Eigenvalues/Eigenvectors continued, and application of eigenvalues to difference equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_algebra/7b-numerical-eigenvalues.html">
     Numerical Calculations of Eigenvalues/Eigenvectors in python
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="ordinary_differential_equations.html">
   Ordinary Differential Equations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="8-differential-equations.html">
     Intro to Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="9-exact-ode.html">
     Exact ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="10-linear-ode.html">
     Linear 1st-order ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="11-linear-ode-example.html">
     Application of linear ODEs to ChE examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="12-second-order-odes.html">
     Second Order Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="13-non-homogeneous-linear-odes.html">
     Non-homogeneous linear ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-MoUC-VoP.html">
     Method of Undetermined Coefficient and Variations of Parameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15-springs-numerical-odes.html">
     Introduction to Numerical Solution of Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="16-coupled-odes.html">
     Coupled Differential Equations
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Coupled Differential Equations Continued!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="18-nonlinear-coupled-ODEs.html">
     Nonlinear coupled ODE’s
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="19-linear-stability.html">
     Steady states in Non-Linear Coupled ODE’s
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="20-BVP.html">
     Boundary value problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="21-BVP-shooting-method.html">
     The Shooting Method for Solving BVPs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../partial_differential_equations/partial_differential_equations.html">
   Partial Differential Equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../partial_differential_equations/22-Intro-PDEs.html">
     Partial Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../partial_differential_equations/23-Fourier-Coefficients.html">
     Fourier Coefficients!
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../statistics/statistics.html">
   Statistics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../statistics/24-intro-statistics.html">
     Intro to engineering statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../statistics/25-statistics-continue-linear-regression.html">
     Stats continued and linear regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../statistics/26-bonus-nonlinear-regression.html">
     Non-linear regression
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course-recap.html">
   06-262 Math Methods Recap
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ulissigroup/math-methods-chemical-engineering/main?urlpath=lab/tree/math-methods-chemical-engineering/notes/ordinary_differential_equations/17-coupled-ode-continued.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/ulissigroup/math-methods-chemical-engineering/blob/main/math-methods-chemical-engineering/notes/ordinary_differential_equations/17-coupled-ode-continued.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ulissigroup/math-methods-chemical-engineering"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ulissigroup/math-methods-chemical-engineering/issues/new?title=Issue%20on%20page%20%2Fnotes/ordinary_differential_equations/17-coupled-ode-continued.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/notes/ordinary_differential_equations/17-coupled-ode-continued.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Coupled Differential Equations Continued!
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recap-for-coupled-differential-equations">
   Recap for coupled differential equations:
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-let-s-look-at-complex-eigenvalues">
     Now let’s look at complex eigenvalues
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-solution-for-complex-eigenvalues">
     General solution for complex eigenvalues
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-solution-to-this-example">
       Numerical solution to this example
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-than-two-coupled-linear-equations">
     More than two coupled linear equations:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-solution">
       Numerical solution
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-handle-non-homogeneous-systems">
     How do we handle non-homogeneous systems
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-solutions">
       Numerical solutions
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-homogeneous-system-vop-method">
     Non-homogeneous system - VOP Method
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Numerical solution
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Coupled Differential Equations Continued!</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Coupled Differential Equations Continued!
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recap-for-coupled-differential-equations">
   Recap for coupled differential equations:
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-let-s-look-at-complex-eigenvalues">
     Now let’s look at complex eigenvalues
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-solution-for-complex-eigenvalues">
     General solution for complex eigenvalues
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-solution-to-this-example">
       Numerical solution to this example
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-than-two-coupled-linear-equations">
     More than two coupled linear equations:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-solution">
       Numerical solution
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-handle-non-homogeneous-systems">
     How do we handle non-homogeneous systems
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-solutions">
       Numerical solutions
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-homogeneous-system-vop-method">
     Non-homogeneous system - VOP Method
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Numerical solution
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="math notranslate nohighlight">
\[\newcommand{\arr}[1]{\underline{\underline{#1}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\vec}[1]{\underline{#1}}\]</div>
<div class="math notranslate nohighlight">
\[\require{mhchem}\]</div>
<section class="tex2jax_ignore mathjax_ignore" id="coupled-differential-equations-continued">
<h1>Coupled Differential Equations Continued!<a class="headerlink" href="#coupled-differential-equations-continued" title="Permalink to this headline">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="recap-for-coupled-differential-equations">
<h1>Recap for coupled differential equations:<a class="headerlink" href="#recap-for-coupled-differential-equations" title="Permalink to this headline">#</a></h1>
<p>Coupled homogeneous 1st order ODEs:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\vec{y'} = \arr{A} \vec{y}\)</span> where <span class="math notranslate nohighlight">\(\vec{y}\)</span> is a vector of unknown functions.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{y} = [y_1, y_2, y_3, ... y_n]^T\)</span> represents an <span class="math notranslate nohighlight">\(n^{th}\)</span> order system with <span class="math notranslate nohighlight">\(n\times n \ \arr{A}\)</span></p></li>
<li><p>We assumed that <span class="math notranslate nohighlight">\(\vec{x}e^{\lambda t}\)</span> was a solution, then showed that it was.</p></li>
<li><p>We proved that the eigenvalues and eigenvectors of <span class="math notranslate nohighlight">\(\arr{A}\)</span> yield the solution</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-f3ac60bc-cd4a-4f12-8117-4c0b464f34c8">
<span class="eqno">(403)<a class="headerlink" href="#equation-f3ac60bc-cd4a-4f12-8117-4c0b464f34c8" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y} = c_1\vec{x}^{(1)}e^{\lambda_1t} + c_2\vec{x}^{(2)}e^{\lambda_2t} + ... + c_n\vec{x}^{(n)}e^{\lambda_n t}
\end{align}\]</div>
<ul class="simple">
<li><p>In the last class, we looked at examples of coupled <span class="math notranslate nohighlight">\(1^\circ\)</span> ODEs with real, distict eigenvalues.</p></li>
</ul>
<section id="now-let-s-look-at-complex-eigenvalues">
<h2>Now let’s look at complex eigenvalues<a class="headerlink" href="#now-let-s-look-at-complex-eigenvalues" title="Permalink to this headline">#</a></h2>
<p><span class="math notranslate nohighlight">\(\underline{\text{Ex}}\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9f6f8f69-2e86-4e4d-8722-98ef18e102e0">
<span class="eqno">(404)<a class="headerlink" href="#equation-9f6f8f69-2e86-4e4d-8722-98ef18e102e0" title="Permalink to this equation">#</a></span>\[\begin{align}
y_1' &amp;= 2y_2\\
y_2' &amp;= -2y_1\\
\begin{bmatrix}y_1' \\ y_2' \end{bmatrix} &amp;= \begin{bmatrix} 0 &amp; 2 \\ -2 &amp; 0 \end{bmatrix} \begin{bmatrix} y_1 \\ y_2 \end{bmatrix}\\
\implies \vec{y}' &amp;= \arr{A}\vec{y} \text{  where } \arr{A} = \begin{bmatrix} 0 &amp; 2 \\ -2 &amp; 0 \end{bmatrix}
\end{align}\]</div>
<p>Can you guess what the solutions are going to look like?</p>
<ol class="simple">
<li><p>Find eigenvalues of <span class="math notranslate nohighlight">\(\arr{A}\)</span>:</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-310559e5-5593-48c9-8e5c-11ac18f75fcd">
<span class="eqno">(405)<a class="headerlink" href="#equation-310559e5-5593-48c9-8e5c-11ac18f75fcd" title="Permalink to this equation">#</a></span>\[\begin{align}
\det(\arr{A} - \lambda\arr{I}) = 0\\
\left| \begin{array}{}0 - \lambda &amp; 2 \\ -2 &amp; 0-\lambda \end{array}\right| = 0 = \lambda^2 + 4\\
\lambda = \pm 2i \rightarrow \lambda_1 = 2i, \  \lambda_2 = -2i
\end{align}\]</div>
<ol class="simple">
<li><p>Find eigenvectors<br />
Set <span class="math notranslate nohighlight">\((\arr{A} - \lambda\arr{I})\vec{x}^{(1)} = \vec{0}\)</span></p></li>
</ol>
<ul class="simple">
<li><p>For <span class="math notranslate nohighlight">\(\lambda_1 = 2i\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-95bf80d7-2274-418e-99ef-03ee99c26c49">
<span class="eqno">(406)<a class="headerlink" href="#equation-95bf80d7-2274-418e-99ef-03ee99c26c49" title="Permalink to this equation">#</a></span>\[\begin{align}
  \begin{bmatrix} -2i &amp; 2 \\ -2 &amp; -2i\end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \end{bmatrix}\\
  \implies -2ix_1 + 2x_2 = 0\\
  [-2x_1 - 2ix_2 = 0]i &amp;&amp; \text{(redundant)}
  \rightarrow -2ix_1 + 2x_2 = 0\\
  ix_1 = x_2 \implies \vec{x}^{(1)} = \begin{bmatrix} 1 \\ i \end{bmatrix}
  \end{align}\]</div>
<ul class="simple">
<li><p>For <span class="math notranslate nohighlight">\(\lambda_2 = -2i\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-63b25529-02d6-4610-9cbc-919a55463568">
<span class="eqno">(407)<a class="headerlink" href="#equation-63b25529-02d6-4610-9cbc-919a55463568" title="Permalink to this equation">#</a></span>\[\begin{align}
\begin{bmatrix} 2i &amp; 2 \\ -2 &amp; 2i \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \end{bmatrix}\\
\implies 2ix_1 + 2x_2 = 0\\
-ix_1 = x_2 \implies \vec{x}^{(2)} = \begin{bmatrix} 1 \\ i \end{bmatrix} = \begin{bmatrix} i \\ 1 \end{bmatrix}
  \end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\therefore\)</span> General solution is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-063ef459-7af4-451f-8842-ab15710c4d14">
<span class="eqno">(408)<a class="headerlink" href="#equation-063ef459-7af4-451f-8842-ab15710c4d14" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y} = c_1 \begin{bmatrix} 1 \\ i \end{bmatrix}e^{2it} + c_2 \begin{bmatrix} 1 \\ -i \end{bmatrix} e^{-2it}
\end{align}\]</div>
<p>Not very useful since it’s imaginary</p>
<ul class="simple">
<li><p>We will again use Euler’s Formula:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-115f8d59-5b82-4be8-bcaf-b22239e22221">
<span class="eqno">(409)<a class="headerlink" href="#equation-115f8d59-5b82-4be8-bcaf-b22239e22221" title="Permalink to this equation">#</a></span>\[\begin{align}
e^{2it} &amp;= \cos(2t) + i\sin(2t)\\
e^{-2it} &amp;= \cos(-2t) + i\sin(-2t)\\
&amp;= \cos(2t) - i\sin(2t)
\end{align}\]</div>
<ul class="simple">
<li><p>Looking at part of the solution:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-8816765c-eb16-479e-ab30-31a0779675f9">
<span class="eqno">(410)<a class="headerlink" href="#equation-8816765c-eb16-479e-ab30-31a0779675f9" title="Permalink to this equation">#</a></span>\[\begin{align}
\begin{bmatrix} 1 \\ i \end{bmatrix} e^{2it} &amp;= \begin{bmatrix} 1 \\ i \end{bmatrix} (\cos 2t + i\sin 2t)\\
&amp;= \begin{bmatrix} \cos 2t + i\sin 2t \\ i\cos 2t - \sin 2t \end{bmatrix}\\
&amp;= \begin{bmatrix} \cos 2t \\ -\sin 2t \end{bmatrix} + i \begin{bmatrix} \sin 2t \\ \cos 2t\end{bmatrix}\\
&amp;= \vec{a} + i\vec{b}\\
\begin{bmatrix} 1 \\ -i \end{bmatrix} e^{-2it} &amp;= \begin{bmatrix} 1 \\ -i \end{bmatrix} (\cos 2t - i\sin 2t)\\
&amp;= \begin{bmatrix} \cos 2t - i\sin 2t \\ -i\cos 2t - \sin 2t \end{bmatrix}\\
&amp;= \begin{bmatrix} \cos 2t \\ -\sin 2t \end{bmatrix} - i \begin{bmatrix} \sin 2t \\ \cos 2t\end{bmatrix}\\
&amp;= \vec{a} - i\vec{b}
\end{align}\]</div>
<ul class="simple">
<li><p>Can we form real solutions from the imaginary solutions?<br />
<span class="math notranslate nohighlight">\(\implies\)</span> Let’s try multiplying sum of imaginary solutions by <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-90b52b47-108a-4baa-8ab8-b7cee66e9e1b">
<span class="eqno">(411)<a class="headerlink" href="#equation-90b52b47-108a-4baa-8ab8-b7cee66e9e1b" title="Permalink to this equation">#</a></span>\[\begin{align}
\frac{1}{2} \left\{\begin{bmatrix} 1 \\ i \end{bmatrix} e^{2it} + \begin{bmatrix} 1 \\ -i\end{bmatrix}e^{-2it} \right\} &amp;= \frac{1}{2}(\vec{a} + i\vec{b} + \vec{a} - i\vec{b})\\
&amp;= \frac{1}{2}(2\vec{a})\\
&amp;= \vec{a} &amp;&amp; \rightarrow\text{the sum of two linearly independent solutions is also a solution}\\
-\frac{i}{2} \left\{\begin{bmatrix} 1 \\ i \end{bmatrix} e^{2it} - \begin{bmatrix} 1 \\ -i\end{bmatrix}e^{-2it} \right\} &amp;= -\frac{i}{2}(\vec{a} + i\vec{b} - \vec{a} + i\vec{b})\\
&amp;= -\frac{i}{2}\cdot 2i\vec{b}\\
&amp;= \vec{b} &amp;&amp; \rightarrow\text{the difference of two linearly independent solutions is also a solution}
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\therefore \vec{y} = c_1 \vec{a} + c_2 \vec{b}\)</span> is a real representation of the general solution</p>
<div class="amsmath math notranslate nohighlight" id="equation-fdef34de-7b08-4fe8-a892-a5ee41517384">
<span class="eqno">(412)<a class="headerlink" href="#equation-fdef34de-7b08-4fe8-a892-a5ee41517384" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y} = c_1 \begin{bmatrix} \cos 2t \\ -\sin 2t \end{bmatrix} + c_2 \begin{bmatrix} \sin 2t \\ \cos 2t \end{bmatrix}
\end{align}\]</div>
<p>OR</p>
<div class="amsmath math notranslate nohighlight" id="equation-7384ef60-9328-4644-8c0b-724fdb32df39">
<span class="eqno">(413)<a class="headerlink" href="#equation-7384ef60-9328-4644-8c0b-724fdb32df39" title="Permalink to this equation">#</a></span>\[\begin{align}
y_1(t) &amp;= c_1 \cos 2t + c_2 \sin 2t\\
y_2(t) &amp;= -c_1\sin 2t + c_2\cos 2t
\end{align}\]</div>
</section>
<section id="general-solution-for-complex-eigenvalues">
<h2>General solution for complex eigenvalues<a class="headerlink" href="#general-solution-for-complex-eigenvalues" title="Permalink to this headline">#</a></h2>
<p>We don’t have to go through all of this work every time!</p>
<ul class="simple">
<li><p>For pairs of complex conjugate eigenvalues <span class="math notranslate nohighlight">\(\lambda\pm  \omega i\)</span> with eigenvectors <span class="math notranslate nohighlight">\(\vec{x}=\vec{a}\pm \vec{b}i\)</span> (the eigenvectors are also complex conjugates), the form will be:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-1b4bad9f-01ea-411f-b3ad-65661d9d34db">
<span class="eqno">(414)<a class="headerlink" href="#equation-1b4bad9f-01ea-411f-b3ad-65661d9d34db" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}=e^\lambda t\left[c_1(\vec{a}\cos\omega t-\vec{b}\sin \omega t)+c_2(\vec{a}\sin\omega t+\vec{b}\cos \omega t)\right]
\end{align}\]</div>
<ul class="simple">
<li><p>To be clear, here <span class="math notranslate nohighlight">\(\vec{a}\)</span> is the real part of the eigenvector, and <span class="math notranslate nohighlight">\(\vec{b}\)</span> is the imaginary part of the eigenvector.</p></li>
<li><p>For the above example (<span class="math notranslate nohighlight">\(\lambda=\pm 2i\)</span>, eigenvector <span class="math notranslate nohighlight">\(\vec{x}=[1,\pm i]\)</span>, this yields</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-50373053-ef22-4dd9-a9fb-3f6e94278a82">
<span class="eqno">(415)<a class="headerlink" href="#equation-50373053-ef22-4dd9-a9fb-3f6e94278a82" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}&amp;=e^0 t\left[c_1\left(\begin{bmatrix}1\\0\end{bmatrix}\cos2 t-\begin{bmatrix}0\\1\end{bmatrix}\sin 2 t\right)+c_2\left(\begin{bmatrix}1\\0\end{bmatrix}\sin2 t+\begin{bmatrix}0\\1\end{bmatrix}\cos 2 t\right)\right]\\
y_1&amp;=c_1\cos2t +c_2 \sin2t\\
y_2&amp;=-c_1\sin 2t+c_2\cos2t
\end{align}\]</div>
<section id="numerical-solution-to-this-example">
<h3>Numerical solution to this example<a class="headerlink" href="#numerical-solution-to-this-example" title="Permalink to this headline">#</a></h3>
<p>Remember, when we solve this numerically, we also need initial conditions. So let’s say that <span class="math notranslate nohighlight">\(y_1(t=0)=2\)</span> and <span class="math notranslate nohighlight">\(y_2(t=0)=0.5\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">linear_homogeneous_diffeq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">A</span><span class="nd">@y</span>

<span class="k">def</span> <span class="nf">linear_diffeq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
          <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>


<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">linear_homogeneous_diffeq</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y&#39;)
</pre></div>
</div>
<img alt="../../_images/17-coupled-ode-continued_7_1.png" src="../../_images/17-coupled-ode-continued_7_1.png" />
</div>
</div>
</section>
</section>
<section id="more-than-two-coupled-linear-equations">
<h2>More than two coupled linear equations:<a class="headerlink" href="#more-than-two-coupled-linear-equations" title="Permalink to this headline">#</a></h2>
<p>Very easy to add more to our systems</p>
<p><span class="math notranslate nohighlight">\(\underline{\text{Ex}}\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f23e902d-6847-4a98-a5ff-62ab7f822f8c">
<span class="eqno">(416)<a class="headerlink" href="#equation-f23e902d-6847-4a98-a5ff-62ab7f822f8c" title="Permalink to this equation">#</a></span>\[\begin{align}
y_1' &amp;= 3y_1 + 5y_2 + 3y_3\\
y_2' &amp;= 4y_2 + 6y_3\\
y_3' &amp;= y_3
\end{align}\]</div>
<ul class="simple">
<li><p>Note that equation 3 isn’t coupled, so in this case we can either solve that separately and plug into first two, or treat as 3D system:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-31916036-c779-48e6-9b5f-ff301e564d76">
<span class="eqno">(417)<a class="headerlink" href="#equation-31916036-c779-48e6-9b5f-ff301e564d76" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}' = \arr{A}\vec{y} \ \text{ where } \vec{y} = \begin{bmatrix} y_1 \\ y_2 \\ y_3 \end{bmatrix} \text{ and } \arr{A} = \begin{bmatrix} 3 &amp; 5 &amp; 3 \\ 0 &amp; 4 &amp; 6 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}
\end{align}\]</div>
<ul class="simple">
<li><p>The solution will be of the form:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-f08d1519-9a2e-42d6-afdd-e469e6070543">
<span class="eqno">(418)<a class="headerlink" href="#equation-f08d1519-9a2e-42d6-afdd-e469e6070543" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y} = c_1 \vec{x}^{(1)}e^{\lambda_1 t} + c_2 \vec{x}^{(2)}e^{\lambda_2 t} + c_3 \vec{x}^{(3)}e^{\lambda_3 t} 
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span>’s are the eigenvalues of <span class="math notranslate nohighlight">\(\arr{A}\)</span> and <span class="math notranslate nohighlight">\(\vec{x}^{(i)}\)</span>’s are the eigenvectors of <span class="math notranslate nohighlight">\(\arr{A}\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-6f83ecef-86f5-45c4-8a2f-67f178f963c3">
<span class="eqno">(419)<a class="headerlink" href="#equation-6f83ecef-86f5-45c4-8a2f-67f178f963c3" title="Permalink to this equation">#</a></span>\[\begin{align}
\arr{A} &amp;= \begin{bmatrix} 3 &amp; 5 &amp; 3 \\ 0 &amp; 4 &amp; 6 \\ 0 &amp; 0 &amp; 1 \end{bmatrix} \\
\implies \lambda_1 &amp;= 3,\ \vec{x}^{(1)} = \begin{bmatrix} 1 &amp; 0 &amp; 0 \end{bmatrix}^T\\
\lambda_2 &amp;= 4,\ \vec{x}^{(2)} = \begin{bmatrix} 5 &amp; 1 &amp; 0 \end{bmatrix}^T\\
\lambda_3 &amp;= 1,\ \vec{x}^{(3)} = \begin{bmatrix} 7 &amp; -4 &amp; 2 \end{bmatrix}^T
\end{align}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-75abba40-85aa-49e4-91c1-08c5dac40fd5">
<span class="eqno">(420)<a class="headerlink" href="#equation-75abba40-85aa-49e4-91c1-08c5dac40fd5" title="Permalink to this equation">#</a></span>\[\begin{align}
\therefore \vec{y} = c_1 \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} e^{3t} + c_2 \begin{bmatrix} 5 \\ 1 \\ 0 \end{bmatrix} e^{4t} + c_3 \begin{bmatrix} 7 \\ -4 \\ 2 \end{bmatrix} e^{t} 
\end{align}\]</div>
<p>OR:</p>
<div class="amsmath math notranslate nohighlight" id="equation-a91a5e21-005c-446a-ac2d-ab7a1e7fc05d">
<span class="eqno">(421)<a class="headerlink" href="#equation-a91a5e21-005c-446a-ac2d-ab7a1e7fc05d" title="Permalink to this equation">#</a></span>\[\begin{align}
y_1(t) &amp;= c_1 e^{3t} + 5c_2e^{4t} + 7c_3e^t\\
y_2(t) &amp;= c_2e^{4t} - 4c_3e^t\\
y_3(t) &amp;= 2c_3e^t 
\end{align}\]</div>
<ul class="simple">
<li><p>It’s easy to check the solution to <span class="math notranslate nohighlight">\(y_3\)</span> as it can be decoupled and is a solution to <span class="math notranslate nohighlight">\(y_3' = y_3\)</span>.</p></li>
<li><p>Will need three initial conditions to find particular solution.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Quick numerical check to convince us that the eigenvalues/eigenvectors </span>
<span class="c1"># are correct above</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">eigval</span><span class="p">,</span><span class="n">eigvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigvec</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigvec</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span><span class="o">/</span><span class="n">eigvec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3. 4. 1.]
[ 0.84270097 -0.48154341  0.24077171]
[ 7. -4.  2.]
</pre></div>
</div>
</div>
</div>
<section id="numerical-solution">
<h3>Numerical solution<a class="headerlink" href="#numerical-solution" title="Permalink to this headline">#</a></h3>
<p>We need three initial conditions now. Let’s say <span class="math notranslate nohighlight">\(y_1(0)=4, y_2(0)=2, y_3(0)=6\)</span>. Almost no changes from the above code</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">linear_homogeneous_diffeq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">A</span><span class="nd">@y</span>

<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">linear_homogeneous_diffeq</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y&#39;)
</pre></div>
</div>
<img alt="../../_images/17-coupled-ode-continued_11_1.png" src="../../_images/17-coupled-ode-continued_11_1.png" />
</div>
</div>
</section>
</section>
<section id="how-do-we-handle-non-homogeneous-systems">
<h2>How do we handle non-homogeneous systems<a class="headerlink" href="#how-do-we-handle-non-homogeneous-systems" title="Permalink to this headline">#</a></h2>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> Same idea as single equations</p>
<div class="amsmath math notranslate nohighlight" id="equation-dabf33b1-d713-4e64-b3af-b0780c133dc0">
<span class="eqno">(422)<a class="headerlink" href="#equation-dabf33b1-d713-4e64-b3af-b0780c133dc0" title="Permalink to this equation">#</a></span>\[\begin{align}
y_1' &amp;= -3y_1 + y_2 + 3\cos t\\
y_2' &amp;= y_1 -3y_2 -2\cos t -3\sin t\\
\begin{bmatrix} y_1' \\ y_2' \end{bmatrix} &amp;= \begin{bmatrix} -3 &amp; 1 \\ 1 &amp; -3 \end{bmatrix} \begin{bmatrix} y_1 \\ y_2 \end{bmatrix} + \begin{bmatrix} 3\cos t \\ -2\cos t - 3\sin t \end{bmatrix}\\
\vec{y}' &amp;= \arr{A}\vec{y} + \vec{g}(t) \text{ where $\vec{g}$ is a vector with no dependence on $\vec{y}$}
\end{align}\]</div>
<ol class="simple">
<li><p>Solve homogeneous system. From <span class="math notranslate nohighlight">\(\arr{A}\)</span>:</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-f256657b-1537-4516-8010-8254ef2aa49e">
<span class="eqno">(423)<a class="headerlink" href="#equation-f256657b-1537-4516-8010-8254ef2aa49e" title="Permalink to this equation">#</a></span>\[\begin{align}
\lambda_1 = -4 &amp;&amp; \vec{x}^{(1)} = \begin{bmatrix} -1 &amp; 1 \end{bmatrix}^T\\
\lambda_2 = -2 &amp;&amp; \vec{x}^{(2)} = \begin{bmatrix} 1 &amp; 1 \end{bmatrix}^T
\end{align}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-a649a4eb-3065-4f47-8c4d-f9f346c906ce">
<span class="eqno">(424)<a class="headerlink" href="#equation-a649a4eb-3065-4f47-8c4d-f9f346c906ce" title="Permalink to this equation">#</a></span>\[\begin{align}
\therefore \vec{y}_H (t) = c_1\begin{bmatrix} -1 \\ 1 \end{bmatrix} e^{-4t} + c_2 \begin{bmatrix} 1 \\ 1 \end{bmatrix} e^{-2t}
\end{align}\]</div>
<ol class="simple">
<li><p>Solve non-homogeneous part</p></li>
</ol>
<ul class="simple">
<li><p>Now, the particular solution <span class="math notranslate nohighlight">\(\vec{y}_P\)</span> is a vector</p></li>
<li><p>For this example use MoUC. Choose <span class="math notranslate nohighlight">\(\vec{y}_P\)</span> based on <span class="math notranslate nohighlight">\(\vec{g} = \begin{bmatrix} 3\cos t \\ -2\cos t -3\sin t \end{bmatrix}\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-75d8f395-215f-4e17-810e-add55ef573f4">
<span class="eqno">(425)<a class="headerlink" href="#equation-75d8f395-215f-4e17-810e-add55ef573f4" title="Permalink to this equation">#</a></span>\[\begin{align}
  \vec{y}_P = \vec{u}\sin t + \vec{v}\cos t
  \end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{u} = \begin{bmatrix} u_1 \\ u_2 \end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\vec{v} = \begin{bmatrix} v_1 \\ v_2 \end{bmatrix}\)</span> are the vectors of undetermined coefficients.<br />
Then, <span class="math notranslate nohighlight">\(\vec{y}_P' = \vec{u} \cos t - \vec{v}\sin t\)</span></p>
<ul class="simple">
<li><p>Plug in expressions for <span class="math notranslate nohighlight">\(\vec{y}_P\)</span> and <span class="math notranslate nohighlight">\(\vec{y}_P'\)</span> into <span class="math notranslate nohighlight">\(\vec{y}_P' = \arr{A}\vec{y}_P + \vec{g}\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-b5a8433f-059f-4eba-ba7c-391b76ea8331">
<span class="eqno">(426)<a class="headerlink" href="#equation-b5a8433f-059f-4eba-ba7c-391b76ea8331" title="Permalink to this equation">#</a></span>\[\begin{align}
  \vec{u}\cos t - \vec{v}\sin t = \arr{A}(\vec{u}\sin t + \vec{v}\cos t) + \vec{g}\\
  (\vec{u} - \arr{A}\vec{v})\cos t - (\arr{A}\vec{u} + \vec{v})\sin t = \vec{g}
  \end{align}\]</div>
<ul class="simple">
<li><p>Match coefficients:</p>
<ul>
<li><p>cos(t) terms (two equations):</p></li>
</ul>
</li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-c8097d66-76b1-4fb6-acc4-067c464dc01c">
<span class="eqno">(427)<a class="headerlink" href="#equation-c8097d66-76b1-4fb6-acc4-067c464dc01c" title="Permalink to this equation">#</a></span>\[\begin{align}
    \vec{u} - \arr{A}\vec{v} = \begin{bmatrix} 3 \\ -2 \end{bmatrix} 
    \end{align}\]</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* sin(t) terms (two equations):
\begin{align}
-\arr{A} \vec{u} -\vec{v} = \begin{bmatrix} 0 \\ -3 \end{bmatrix} 
\end{align}
</pre></div>
</div>
<ul class="simple">
<li><p>Solve system:<br />
From first equation: <span class="math notranslate nohighlight">\(\vec{u} = \begin{bmatrix} 3 \\ -2 \end{bmatrix} + \arr{A}\vec{v}\)</span><br />
Plug into second equation:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-cb3d9935-1213-464a-ab49-859b8f26a68a">
<span class="eqno">(428)<a class="headerlink" href="#equation-cb3d9935-1213-464a-ab49-859b8f26a68a" title="Permalink to this equation">#</a></span>\[\begin{align}
  -\arr{A}\left(\begin{bmatrix} 3 \\ -2 \end{bmatrix} + \arr{A}\vec{v} \right) - \vec{v} = \begin{bmatrix} 0 \\ -3 \end{bmatrix}\\
  \text{simplifies to }\ \begin{bmatrix} -11 &amp; 6 \\ 6 &amp; -11 \end{bmatrix} \begin{bmatrix}v_1 \\ v_2\end{bmatrix} = \begin{bmatrix} -11 \\ 6 \end{bmatrix}\\
  \left[\begin{array}{ll|l}-11 &amp; 6 &amp; -11 \\ 6 &amp; -11 &amp; 6\end{array}\right] \text{ G.E} \rightarrow \left[\begin{array}{ll|l} 1&amp;0&amp;1 \\ 0&amp;1&amp;0\end{array} \right]\\
  \therefore \vec{v} = \begin{bmatrix} 1 \\ 0 \end{bmatrix} \text{ and } \vec{u} = \begin{bmatrix} 3 \\ -2 \end{bmatrix} + \arr{A}\begin{bmatrix} 1 \\ 0 \end{bmatrix} = \begin{bmatrix} 0 \\ -1 \end{bmatrix}\\
  \therefore \vec{y}_P = \begin{bmatrix} 0 \\ -1 \end{bmatrix} \sin t + \begin{bmatrix} 1 \\ 0 \end{bmatrix} \cos t
  \end{align}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight" id="equation-869d33af-a2f5-4c2c-b81d-1b4634a07423">
<span class="eqno">(429)<a class="headerlink" href="#equation-869d33af-a2f5-4c2c-b81d-1b4634a07423" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}(t) = c_1 \begin{bmatrix} -1 \\ 1 \end{bmatrix} e^{-4t} + c_2 \begin{bmatrix} 1 \\ 1 \end{bmatrix} e^{-2t} + \begin{bmatrix} 0 \\ -1 \end{bmatrix} \sin t + \begin{bmatrix} 1 \\ 0 \end{bmatrix} \cos t
\end{align}\]</div>
<p>Notice that this says the initial conditions don’t matter after a while!!</p>
<section id="numerical-solutions">
<h3>Numerical solutions<a class="headerlink" href="#numerical-solutions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">linear_nonhomogeneous_diffeq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">A</span><span class="nd">@y</span> <span class="o">+</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
                <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">400000</span><span class="p">]</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">linear_nonhomogeneous_diffeq</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-2.0, 2.0)
</pre></div>
</div>
<img alt="../../_images/17-coupled-ode-continued_14_1.png" src="../../_images/17-coupled-ode-continued_14_1.png" />
</div>
</div>
</section>
</section>
<section id="non-homogeneous-system-vop-method">
<h2>Non-homogeneous system - VOP Method<a class="headerlink" href="#non-homogeneous-system-vop-method" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Find the general solution to <span class="math notranslate nohighlight">\(\vec{y}' = \begin{bmatrix}-2 &amp; 1 \\ 1 &amp; -2  \end{bmatrix}\vec{y} + \begin{bmatrix} 2e^{-t} \\ 3t \end{bmatrix}\)</span><br />
same as:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-ef8ac434-0602-422b-8f13-dd67f5d38200">
<span class="eqno">(430)<a class="headerlink" href="#equation-ef8ac434-0602-422b-8f13-dd67f5d38200" title="Permalink to this equation">#</a></span>\[\begin{align}
y_1' &amp;= -2y_1 + y_2 + 2e^{-t}\\
y_2' &amp;= y_1 -2y_2 + 3t\\
\vec{y}' &amp;= \arr{A}\vec{y} + \vec{g}(t)
\end{align}\]</div>
<ol class="simple">
<li><p>Solve homogeneous system<br />
from <span class="math notranslate nohighlight">\(\arr{A} \rightarrow |\arr{A}-\lambda\arr{I}|=0\)</span></p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-bd427969-f39c-4c91-80cd-64a70c5bca76">
<span class="eqno">(431)<a class="headerlink" href="#equation-bd427969-f39c-4c91-80cd-64a70c5bca76" title="Permalink to this equation">#</a></span>\[\begin{align}
\left|\begin{array}{} -2-\lambda &amp; 1 \\ 1 &amp; -2-\lambda \end{array}\right| = 0 &amp; = (-2-\lambda)(-2-\lambda) -1\\
&amp;= +4 + 2\lambda + 2 \lambda + \lambda^2 - 1\\
&amp;= \lambda^2 + 4\lambda + 3 = (\lambda + 3)(\lambda + 1)\\
\lambda_1 &amp;= -3 ; \ \lambda_2 = -1
\end{align}\]</div>
<p>then <span class="math notranslate nohighlight">\((\arr{A} - \lambda\arr{I})\vec{x} = \vec{0}\)</span><br />
For <span class="math notranslate nohighlight">\(\lambda_1=-3\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-ff634523-0a4b-4994-a89e-eccac5f88b1a">
<span class="eqno">(432)<a class="headerlink" href="#equation-ff634523-0a4b-4994-a89e-eccac5f88b1a" title="Permalink to this equation">#</a></span>\[\begin{align}
\left[\begin{array}{ll|l} 1 &amp; 1 &amp; 0 \\ 1 &amp; 1 &amp; 0 \end{array} \right] \rightarrow x_1 + x_2 = 0 \implies x_1 = -x_2 \implies \vec{x}^{(1)} = \begin{bmatrix} 1 \\ -1 \end{bmatrix}
\end{align}\]</div>
<p>For <span class="math notranslate nohighlight">\(\lambda_2=-1\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-26ee0ef1-885a-484d-82b0-716721e00628">
<span class="eqno">(433)<a class="headerlink" href="#equation-26ee0ef1-885a-484d-82b0-716721e00628" title="Permalink to this equation">#</a></span>\[\begin{align}
\left[\begin{array}{ll|l} -1 &amp; 1 &amp; 0 \\ 1 &amp; -1 &amp; 0 \end{array} \right] \rightarrow -x_1 + x_2 = 0 \implies x_1 = x_2 \implies \vec{x}^{(2)} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}
\end{align}\]</div>
<p>Then,</p>
<div class="amsmath math notranslate nohighlight" id="equation-9800399d-c379-4899-b9f9-341a2dbaaffa">
<span class="eqno">(434)<a class="headerlink" href="#equation-9800399d-c379-4899-b9f9-341a2dbaaffa" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}_H(t) = c_1 \begin{bmatrix} 1 \\ -1 \end{bmatrix} e^{-3t} + c_2\begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{-t}
\end{align}\]</div>
<ol class="simple">
<li><p>Solve non-homogeneous part using Variation of Parameters</p></li>
</ol>
<ul class="simple">
<li><p>Write the homogeneous solution as:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-b3141bf4-9176-4880-80d4-0cedd2d889c0">
<span class="eqno">(435)<a class="headerlink" href="#equation-b3141bf4-9176-4880-80d4-0cedd2d889c0" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}_H(t) &amp;= \begin{bmatrix} y_1^{(1)} &amp; y_1^{(2)} \\ y_2^{(1)} &amp; y_2^{(2)} \end{bmatrix} \begin{bmatrix} c_1 \\ c_2 \end{bmatrix} = \arr{Y}(t)\vec{c}\  \text{ where $\arr{Y}(t)$ is the $``$fundamental matrix&quot;}\\
&amp;= \begin{bmatrix} e^{-3t} &amp; e^{-t} \\ -e^{-3t} &amp; e^{-t}\end{bmatrix} \begin{bmatrix} c_1 \\ c_2 \end{bmatrix}
\end{align}\]</div>
<ul class="simple">
<li><p>Just like with one dimensional case, we will form a particular solution by “replacing” the arbitrary constants of the homogeneous solution with an unknown function of <span class="math notranslate nohighlight">\(t\)</span>, but this time with a vector. Assume <span class="math notranslate nohighlight">\(\vec{y}_P(t) = \arr{Y}(t)\vec{u}(t)\)</span></p></li>
<li><p>We will determine <span class="math notranslate nohighlight">\(\vec{u}(t)\)</span> by substituting <span class="math notranslate nohighlight">\(\vec{y}_P(t)\)</span> into the original system <br />
<span class="math notranslate nohighlight">\(\rightarrow\)</span> let’s derive in general terms</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-2805a2fc-308c-4785-b14e-17a2645d5dba">
<span class="eqno">(436)<a class="headerlink" href="#equation-2805a2fc-308c-4785-b14e-17a2645d5dba" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}' &amp;= \arr{A} \vec{y} + \vec{g} \\
\vec{y}_P' &amp;= \arr{A}\vec{y}_P + \vec{g}\\
(\arr{Y}\vec{u})' &amp;= \arr{A} \arr{Y}\vec{u} + \vec{g}\\
\arr{Y}'\vec{u} &amp;+ \arr{Y}\vec{u}' = \arr{A}\arr{Y}\vec{u} + \vec{g}
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\implies\)</span> because <span class="math notranslate nohighlight">\(\arr{Y}\)</span> is a solution to the homogeneous system, we know it satifies <span class="math notranslate nohighlight">\(\arr{Y}' = \arr{A}\arr{Y}\rightarrow\)</span> substitute this in</p>
<div class="amsmath math notranslate nohighlight" id="equation-947577e5-cc31-4ccb-844a-76cf07208cb8">
<span class="eqno">(437)<a class="headerlink" href="#equation-947577e5-cc31-4ccb-844a-76cf07208cb8" title="Permalink to this equation">#</a></span>\[\begin{align}
\arr{A}\arr{Y}\vec{u} +\arr{Y}\vec{u}' &amp;= \arr{A}\arr{Y}\vec{u} + \vec{g}\\
\arr{Y}^{-1}(\arr{Y}\vec{u}' &amp;= \vec{g}) 
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> can multiply with inverse. We know <span class="math notranslate nohighlight">\(\arr{Y}\)</span> is non singular because <span class="math notranslate nohighlight">\(\det(\arr{Y})=\)</span> Wronskian which is non-zero for a basis</p>
<div class="amsmath math notranslate nohighlight" id="equation-353b08ca-e582-4382-8d5b-9ca2b8fa0143">
<span class="eqno">(438)<a class="headerlink" href="#equation-353b08ca-e582-4382-8d5b-9ca2b8fa0143" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{u}' &amp;= \arr{Y}^{-1} \vec{g}\\
\vec{u}(t) &amp;= \int \arr{Y}^{-1}(t) \vec{g}(t)dt + \vec{c} &amp;&amp; \rightarrow \text{each element is integrated separately}  
\end{align}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight" id="equation-17c3fb40-1d04-49cb-948c-2c1fe6d5b738">
<span class="eqno">(439)<a class="headerlink" href="#equation-17c3fb40-1d04-49cb-948c-2c1fe6d5b738" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}_P(t) &amp;= \arr{Y}(t)\vec{u}(t)\\
&amp;= \arr{Y}(t) \int \arr{Y}^{-1}(t)\vec{g}(t) dt
\end{align}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight" id="equation-7ff8076a-f904-4728-8cba-493124faf0b2">
<span class="eqno">(440)<a class="headerlink" href="#equation-7ff8076a-f904-4728-8cba-493124faf0b2" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}(t) &amp;= \vec{y}_H + \vec{y}_P\\
\vec{y}(t) &amp;= \arr{Y}(t)\vec{c} + \arr{Y}(t) \int \arr{Y}^{-1}(t)\vec{g}(t) dt
\end{align}\]</div>
<ul class="simple">
<li><p>Now for our example:<br />
we need <span class="math notranslate nohighlight">\(\arr{Y}^{-1}(t)\)</span>. Can find using matrix property for a 2x2 matrix:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-795cde9c-11a3-4b01-a9b3-0090b609cb90">
<span class="eqno">(441)<a class="headerlink" href="#equation-795cde9c-11a3-4b01-a9b3-0090b609cb90" title="Permalink to this equation">#</a></span>\[\begin{align}
\arr{A}^{-1} = \frac{1}{\det \arr{A}}\begin{bmatrix} a_{22} &amp; -a_{12} \\ -a_{21} &amp; a_{11} \end{bmatrix}
\end{align}\]</div>
<p>then</p>
<div class="amsmath math notranslate nohighlight" id="equation-3d378f32-8de5-44b1-9081-c66bb6a903a1">
<span class="eqno">(442)<a class="headerlink" href="#equation-3d378f32-8de5-44b1-9081-c66bb6a903a1" title="Permalink to this equation">#</a></span>\[\begin{align}
\arr{Y}^{-1} &amp;= \frac{1}{e^{-4t} + e^{-4t}} \begin{bmatrix} e^{-t} &amp; -e^{-t} \\ e^{-3t} &amp; e^{-3t} \end{bmatrix}\\
&amp;=\frac{1}{2} \begin{bmatrix} e^{3t} &amp; -e^{3t} \\ e^t &amp; e^t \end{bmatrix}\\
\arr{Y}^{-1}\vec{g} &amp;= \frac{1}{2}\begin{bmatrix} e^{3t} &amp; -e^{3t} \\ e^t &amp; e^t \end{bmatrix} \begin{bmatrix} 2e^{-t} \\ 3t\end{bmatrix} \\
&amp;= \frac{1}{2} \begin{bmatrix} 2e^{2t} - 3te^{3t} \\ 2 + 3te^t \end{bmatrix}\\
\vec{u}(t) = \int \arr{Y}^{-1}\vec{g} &amp;= \frac{1}{2} \begin{bmatrix} \int 2e^{2t}dt - \int 3te^{3t}dt \\ \int 2 dt + \int 3t e^t dt \end{bmatrix}\\
&amp;=\frac{1}{2} \begin{bmatrix} e^{2t} - (te^{3t} - \frac{1}{3} e^{3t}) \\ 2t + 3(te^t - e^t) \end{bmatrix}
\end{align}\]</div>
<p>Then</p>
<div class="amsmath math notranslate nohighlight" id="equation-fb21bd7c-fd0b-4631-8965-69a8451c7086">
<span class="eqno">(443)<a class="headerlink" href="#equation-fb21bd7c-fd0b-4631-8965-69a8451c7086" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}_P(t) &amp;= \arr{Y}(t)\vec{u}(t)\\
&amp;= \begin{bmatrix} e^{-3t} &amp; e^{-t} \\ -e^{-3t} &amp; e^{-t} \end{bmatrix} \cdot \frac{1}{2} \cdot \begin{bmatrix} e^{2t}-te^{3t} + \frac{1}{3}e^{3t} \\ 2t + 3te^t - 3e^t \end{bmatrix} \\
&amp;= \frac{1}{2} \begin{bmatrix} e^{-t} -t + \frac{1}{3} + 2te^{-t}+ 3t -3 \\ -e^{-t} + t -\frac{1}{3} + 2te^{-t} + 3t - 3 \end{bmatrix}\\
&amp;= \begin{bmatrix} \frac{1}{2} e^{-t} + te^{-t} + t - \frac{4}{3} \\ -\frac{1}{2} e^{-t} + te^{-t} + 2t - \frac{5}{3}\end{bmatrix}\\
\vec{y}_P(t) &amp;= \frac{1}{2}\begin{bmatrix} 1 \\ -1 \end{bmatrix} e^{-t} + \begin{bmatrix} 1 \\ 1\end{bmatrix} te^{-t} + \begin{bmatrix} 1 \\ 2 \end{bmatrix} t -\frac{1}{3}\begin{bmatrix} 4 \\ 5 \end{bmatrix}
\end{align}\]</div>
<p>Then,</p>
<div class="amsmath math notranslate nohighlight" id="equation-824a8177-e8b0-46ec-84a4-1631c6992896">
<span class="eqno">(444)<a class="headerlink" href="#equation-824a8177-e8b0-46ec-84a4-1631c6992896" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{y}(t) &amp;= \vec{y}_H(t) + \vec{y}_P(t)\\
&amp;= c_1 \begin{bmatrix} 1 \\ -1 \end{bmatrix} e^{-3t} + c_2 \begin{bmatrix} 1 \\ 1 \end{bmatrix} e^{-t} + \frac{1}{2}\begin{bmatrix} 1 \\ -1 \end{bmatrix} e^{-t} + \begin{bmatrix} 1 \\ 1 \end{bmatrix}te^{-t} + \begin{bmatrix} 1 \\ 2 \end{bmatrix} t - \frac{1}{3} \begin{bmatrix} 4 \\ 5 \end{bmatrix} &amp;&amp; \text{general solution} 
\end{align}\]</div>
</section>
<section id="id1">
<h2>Numerical solution<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>Integrate <span class="math notranslate nohighlight">\(\vec{y}' = \begin{bmatrix}-2 &amp; 1 \\ 1 &amp; -2  \end{bmatrix}\vec{y} + \begin{bmatrix} 2e^{-t} \\ 3t \end{bmatrix}\)</span>, with the initial condition <span class="math notranslate nohighlight">\(\vec{y}(t=1)=[4,3]^T\)</span> from t=1 to t=10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">linear_nonhomogeneous_diffeq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">A</span><span class="nd">@y</span> <span class="o">+</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">),</span>
                <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">]</span>

<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">linear_nonhomogeneous_diffeq</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="c1"># plt.ylim([-2,2])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y&#39;)
</pre></div>
</div>
<img alt="../../_images/17-coupled-ode-continued_21_1.png" src="../../_images/17-coupled-ode-continued_21_1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notes/ordinary_differential_equations"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="16-coupled-odes.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Coupled Differential Equations</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="18-nonlinear-coupled-ODEs.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Nonlinear coupled ODE’s</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Zachary Ulissi<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>